{% load static %}
<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>SmartHealth - Dashboard</title>

		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
			rel="stylesheet"
		/>

		<script src="https://cdn.tailwindcss.com"></script>
		<link rel="stylesheet" href="{% static 'css/main.css' %}" />
	</head>

	<body
		class="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 text-slate-900"
	>
		<!-- NAVBAR -->
		<nav class="sticky top-0 z-50 bg-white/90 backdrop-blur shadow">
			<div
				class="mx-auto flex max-w-6xl items-center justify-between px-5 py-4"
			>
				<div class="text-2xl font-extrabold text-indigo-700">
					ğŸ’ª SmartHealth
				</div>

				<div
					class="flex items-center gap-4 text-sm font-semibold text-slate-700"
				>
					<a
						href="{% url 'dashboard' %}"
						class="px-3 py-2 text-indigo-700 border-b-2 border-indigo-600"
						>Home</a
					>
					<a
						href="{% url 'dashboard_diet' %}"
						class="px-3 py-2 hover:text-indigo-600"
						>Diet</a
					>
					<a
						href="{% url 'dashboard_workout' %}"
						class="px-3 py-2 hover:text-indigo-600"
						>Workout</a
					>
				</div>

				<div class="flex items-center gap-3 text-sm font-medium">
					<span class="hidden sm:inline"
						>Hi, {{ user.username }}</span
					>
					<a
						href="{% url 'logout' %}"
						class="rounded-lg bg-red-500 px-4 py-2 text-white font-semibold hover:bg-red-600 transition"
					>
						Logout
					</a>
				</div>
			</div>
		</nav>

		<main class="max-w-6xl mx-auto py-12 px-4 space-y-8">
			{% if error_message %}
			<div class="bg-red-100 border-l-4 border-red-500 p-4 rounded-lg">
				<p class="text-red-700 font-semibold">âš ï¸ {{ error_message }}</p>
			</div>
			{% endif %}

			{% if plan %}
			<!-- USER GOAL CARD -->
			<section class="bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 text-white rounded-3xl shadow-2xl p-8 transform hover:shadow-3xl transition">
				<div class="flex items-start justify-between">
					<div>
						<p class="text-indigo-100 text-sm font-semibold mb-2">YOUR FITNESS GOAL</p>
						<h2 class="text-4xl font-bold mb-3">{{ profile.goal|title }}</h2>
						<p class="text-indigo-100 text-lg">Target Weight: <span class="font-bold text-2xl text-white">{{ profile.target_weight_kg }} kg</span></p>
					</div>
					<div class="text-6xl opacity-20">ğŸƒ</div>
				</div>
			</section>

			<!-- TODAY SUMMARY CARDS -->
			<section>
				<div class="flex items-center gap-3 mb-6">
					<h1 class="text-4xl font-bold text-slate-900">Today's Plan</h1>
					<span class="text-5xl">ğŸ“…</span>
				</div>

				<div class="grid md:grid-cols-2 gap-8">
					<!-- TODAY DIET CARD -->
					<div class="group bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-2xl transition transform hover:scale-105">
						<div class="bg-gradient-to-r from-green-400 to-emerald-500 p-6 text-white">
							<div class="flex items-center gap-3">
								<span class="text-4xl">ğŸ¥—</span>
								<h3 class="text-2xl font-bold">Today's Meals</h3>
							</div>
						</div>
						<div class="p-6">
							{% with plan.diet_plan.0 as today_diet %}
							{% if today_diet %}
							<p class="text-sm font-semibold text-slate-500 mb-4">{{ today_diet.day }}</p>
							<ul class="space-y-3">
								{% for meal in today_diet.meals %}
								<li class="flex gap-3 items-start text-slate-700">
									<span class="text-green-500 font-bold text-xl">âœ“</span>
									<span class="leading-relaxed">{{ meal }}</span>
								</li>
								{% endfor %}
							</ul>
							{% else %}
							<p class="text-slate-500 italic">No meals planned for today</p>
							{% endif %}
							{% endwith %}
						</div>
					</div>

					<!-- TODAY WORKOUT CARD -->
					<div class="group bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-2xl transition transform hover:scale-105">
						<div class="bg-gradient-to-r from-blue-400 to-cyan-500 p-6 text-white">
							<div class="flex items-center gap-3">
								<span class="text-4xl">ğŸ’ª</span>
								<h3 class="text-2xl font-bold">Today's Workout</h3>
							</div>
						</div>
						<div class="p-6">
							{% with plan.workout_plan.0 as today_workout %}
							{% if today_workout %}
							<p class="text-sm font-semibold text-slate-500 mb-4">{{ today_workout.day }}</p>
							<p class="text-slate-700 leading-relaxed text-lg">{{ today_workout.workout }}</p>
							{% else %}
							<p class="text-slate-500 italic">No workout planned for today</p>
							{% endif %}
							{% endwith %}
						</div>
					</div>
				</div>
			</section>

			{% else %}
			<!-- NO PLAN CTA -->
			<section class="bg-gradient-to-br from-slate-50 to-slate-100 rounded-3xl p-16 text-center">
				<div class="max-w-2xl mx-auto">
					<div class="text-7xl mb-6">ğŸš€</div>
					<h2 class="text-4xl font-bold text-slate-900 mb-4">Let's Get Started!</h2>
					<p class="text-xl text-slate-600 mb-8">
						Generate your personalized diet and workout plan based on your profile.
					</p>
					<form method="POST" class="inline-block">
						{% csrf_token %}
						<button
							class="px-10 py-4 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-xl font-bold text-lg shadow-lg hover:shadow-2xl hover:from-indigo-700 hover:to-purple-700 transition transform hover:scale-105"
						>
							Generate My Plan
						</button>
					</form>
				</div>
			</section>
			{% endif %}
		</main>
	</body>
</html>
